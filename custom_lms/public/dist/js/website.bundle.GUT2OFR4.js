(()=>{var ne=Object.create;var bt=Object.defineProperty;var ae=Object.getOwnPropertyDescriptor;var ie=Object.getOwnPropertyNames;var se=Object.getPrototypeOf,re=Object.prototype.hasOwnProperty;var oe=(e,n)=>()=>(n||e((n={exports:{}}).exports,n),n.exports);var le=(e,n,a,t)=>{if(n&&typeof n=="object"||typeof n=="function")for(let i of ie(n))!re.call(e,i)&&i!==a&&bt(e,i,{get:()=>n[i],enumerable:!(t=ae(n,i))||t.enumerable});return e};var ce=(e,n,a)=>(a=e!=null?ne(se(e)):{},le(n||!e||!e.__esModule?bt(a,"default",{value:e,enumerable:!0}):a,e));var kt=oe(V=>{frappe.ready(()=>{de(),he(),$(".enroll-in-course").click(e=>{fe(e)}),$(".notify-me").click(e=>{ge(e)}),$(".nav-link").click(e=>{ve(e)}),window.location.hash&&ye(),window.location.pathname=="/statistics"&&(nt("New Signups","#new-signups"),nt("Course Enrollments","#course-enrollments"),nt("Lesson Completion","#lesson-completion"),me()),xe(),$(".chapter-title").unbind().click(e=>{_e(e)}),$(".no-preview").click(e=>{we(e)}),$("#create-class").click(e=>{Ae(e)}),$("#course-filter").change(e=>{De(e)})});var he=()=>{let e=document.querySelector(".sticky");e&&new IntersectionObserver(([a])=>a.target.classList.toggle("is-pinned",a.intersectionRatio<1),{threshold:[1]}).observe(e)},de=()=>{frappe.provide("frappe.form.formatters"),frappe.form.formatters.FileSize=pe},pe=e=>(e>1048576?e=flt(flt(e)/1048576,1)+"M":e>1024&&(e=flt(flt(e)/1024,1)+"K"),e),fe=e=>{e.preventDefault();let n=$(e.currentTarget).attr("data-course");if(frappe.session.user=="Guest"){window.location.href=`/login?redirect-to=/courses/${n}`;return}let a=$(e.currentTarget).attr("data-batch");a=a?decodeURIComponent(a):"",frappe.call({method:"lms.lms.doctype.lms_enrollment.lms_enrollment.create_membership",args:{batch:a||"",course:n},callback:t=>{t.message=="OK"&&($(".no-preview-modal").modal("hide"),frappe.show_alert({message:__("Enrolled successfully"),indicator:"green"},3),setTimeout(function(){window.location.href=`/courses/${n}/learn/1.1`},1e3))}})},ge=e=>{e.preventDefault();var n=decodeURIComponent($("#outline-heading").attr("data-course"));if(frappe.session.user=="Guest"){window.location.href=`/login?redirect-to=/courses/${n}`;return}frappe.call({method:"lms.lms.doctype.lms_course_interest.lms_course_interest.capture_interest",args:{course:n},callback:a=>{$(".no-preview-modal").modal("hide"),frappe.show_alert({message:__("You have opted to be notified for this course. You will receive an email when the course becomes available."),indicator:"green"},3),setTimeout(()=>{window.location.reload()},3e3)}})},nt=(e,n,a="line")=>{let t=frappe.datetime;frappe.call({method:"lms.lms.utils.get_chart_data",args:{chart_name:e,timespan:"Select Date Range",timegrain:"Daily",from_date:t.add_days(t.get_today(),-30),to_date:t.add_days(t.get_today(),1)},callback:i=>{xt(i.message,e,n,a)}})},xt=(e,n,a,t)=>{let i=new frappe.Chart(a,{title:n,data:e,type:t,height:250,colors:["#4563f1"],axisOptions:{xIsSeries:1},lineOptions:{regionFill:1}})},me=()=>{frappe.call({method:"lms.lms.utils.get_course_completion_data",callback:e=>{xt(e.message,"Course Completion","#course-completion","pie")}})},ve=e=>{window.location.hash=$(e.currentTarget).attr("href")},ye=()=>{$(`a[href="${window.location.hash}"]`).click()},be=()=>{$(".course-home-outline .collapse").each((n,a)=>{if(n<1)return at(a),!1})},xe=()=>{let e=$(".course-home-headings.title");e.length&&$(".course-details-page").length?ke(e):$(".active-lesson").length?(e=$(".active-lesson"),at(e.parent().parent())):be()},ke=e=>{$(".lesson-info").removeClass("active-lesson"),$(".lesson-info").each((n,a)=>{$(a).data("lesson")==e.data("lesson")&&($(a).addClass("active-lesson"),at($(a).parent().parent()))})},at=e=>{$(e).addClass("show"),$(e).siblings(".chapter-title").children(".chapter-icon").css("transform","rotate(90deg)"),$(e).siblings(".chapter-title").attr("aria-expanded",!0)},_e=e=>{let n=$(e.currentTarget).children(".chapter-icon");n.css("transform")=="none"?n.css("transform","rotate(90deg)"):n.css("transform","none")},we=e=>{$("#no-preview-modal").modal("show")},Ae=()=>{V.class_dialog=new frappe.ui.Dialog({title:__("New Class"),fields:[{fieldtype:"Data",label:__("Title"),fieldname:"title",reqd:1,default:class_info&&class_info.title},{fieldtype:"Date",label:__("Start Date"),fieldname:"start_date",reqd:1,default:class_info&&class_info.start_date},{fieldtype:"Date",label:__("End Date"),fieldname:"end_date",reqd:1,default:class_info&&class_info.end_date},{fieldtype:"Select",label:__("Medium"),fieldname:"medium",options:["Online","Offline"],default:class_info&&class_info.medium||"Online"},{fieldtype:"Column Break"},{fieldtype:"Time",label:__("Start Time"),fieldname:"start_time",default:class_info&&class_info.start_time},{fieldtype:"Time",label:__("End Time"),fieldname:"end_time",default:class_info&&class_info.end_time},{fieldtype:"Int",label:__("Seat Count"),fieldname:"seat_count",default:class_info&&class_info.seat_count},{fieldtype:"Link",label:__("Category"),fieldname:"category",options:"LMS Category",default:class_info&&class_info.category},{fieldtype:"Section Break"},{fieldtype:"Small Text",label:__("Description"),fieldname:"description",default:class_info&&class_info.description,reqd:1}],primary_action_label:__("Save"),primary_action:e=>{Ce(e)}}),V.class_dialog.show()},Ce=e=>{frappe.call({method:"lms.lms.doctype.lms_class.lms_class.create_class",args:{title:e.title,start_date:e.start_date,end_date:e.end_date,description:e.description,seat_count:e.seat_count,start_time:e.start_time,end_time:e.end_time,medium:e.medium,category:e.category,name:class_info&&class_info.name},callback:n=>{n.message&&(frappe.show_alert({message:class_info?__("Class Updated"):__("Class Created"),indicator:"green"}),V.class_dialog.hide(),window.location.href=`/classes/${n.message.name}`)}})},De=e=>{let n=$(".course-cards-parent"),a=$(e.currentTarget).val();n.each((t,i)=>{let s=$(i).children(".course-card");s.sort((r,o)=>{var l=$(r).data(a),c=$(o).data(a);return l>c?-1:l<c?1:0}),$(i).append(s)})}});frappe.ready(()=>{ue()});var ue=()=>{if(frappe.session.user=="Guest"){let e=$(".nav-link").filter((n,a)=>$(a).text().trim()==="My Profile"||$(a).text().trim()==="Dashboard");e.length&&e.each((n,a)=>$(a).addClass("hide"))}};var kn=ce(kt());function Z(e){return(Z=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n})(e)}function P(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function _t(e,n){for(var a=0;a<n.length;a++){var t=n[a];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}function S(e,n,a){return n&&_t(e.prototype,n),a&&_t(e,a),e}function j(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),n&&Rt(e,n)}function w(e){return(w=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)})(e)}function Rt(e,n){return(Rt=Object.setPrototypeOf||function(a,t){return a.__proto__=t,a})(e,n)}function Le(e,n){return!n||typeof n!="object"&&typeof n!="function"?function(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}(e):n}function W(e){var n=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(a){return!1}}();return function(){var a,t=w(e);if(n){var i=w(this).constructor;a=Reflect.construct(t,arguments,i)}else a=t.apply(this,arguments);return Le(this,a)}}function L(e,n,a){return(L=typeof Reflect!="undefined"&&Reflect.get?Reflect.get:function(t,i,s){var r=function(l,c){for(;!Object.prototype.hasOwnProperty.call(l,c)&&(l=w(l))!==null;);return l}(t,i);if(r){var o=Object.getOwnPropertyDescriptor(r,i);return o.get?o.get.call(s):o.value}})(e,n,a||e)}function k(e,n){return function(a){if(Array.isArray(a))return a}(e)||function(a,t){if(!(typeof Symbol=="undefined"||!(Symbol.iterator in Object(a)))){var i=[],s=!0,r=!1,o=void 0;try{for(var l,c=a[Symbol.iterator]();!(s=(l=c.next()).done)&&(i.push(l.value),!t||i.length!==t);s=!0);}catch(u){r=!0,o=u}finally{try{s||c.return==null||c.return()}finally{if(r)throw o}}return i}}(e,n)||Ht(e,n)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function T(e){return function(n){if(Array.isArray(n))return lt(n)}(e)||function(n){if(typeof Symbol!="undefined"&&Symbol.iterator in Object(n))return Array.from(n)}(e)||Ht(e)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function Ht(e,n){if(e){if(typeof e=="string")return lt(e,n);var a=Object.prototype.toString.call(e).slice(8,-1);return a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set"?Array.from(e):a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?lt(e,n):void 0}}function lt(e,n){(n==null||n>e.length)&&(n=e.length);for(var a=0,t=new Array(n);a<n;a++)t[a]=e[a];return t}function E(e,n){return typeof e=="string"?(n||document).querySelector(e):e||null}function J(e){var n=e.getBoundingClientRect();return{top:n.top+(document.documentElement.scrollTop||document.body.scrollTop),left:n.left+(document.documentElement.scrollLeft||document.body.scrollLeft)}}function Te(e){return e.offsetParent===null}function Pe(e){var n=e.getBoundingClientRect();return n.top>=0&&n.left>=0&&n.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&n.right<=(window.innerWidth||document.documentElement.clientWidth)}(function(e,n){n===void 0&&(n={});var a=n.insertAt;if(e&&typeof document!="undefined"){var t=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css",a==="top"&&t.firstChild?t.insertBefore(i,t.firstChild):t.appendChild(i),i.styleSheet?i.styleSheet.cssText=e:i.appendChild(document.createTextNode(e))}})(`:root {
  --charts-label-color: #313b44;
  --charts-axis-line-color: #f4f5f6;
  --charts-tooltip-title: var(--charts-label-color);
  --charts-tooltip-label: var(--charts-label-color);
  --charts-tooltip-value: #192734;
  --charts-tooltip-bg: #ffffff;
  --charts-stroke-width: 2px;
  --charts-dataset-circle-stroke: #ffffff;
  --charts-dataset-circle-stroke-width: var(--charts-stroke-width);
  --charts-legend-label: var(--charts-label-color);
  --charts-legend-value: var(--charts-label-color); }

.chart-container {
  position: relative;
  /* for absolutely positioned tooltip */
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Roboto", "Oxygen", "Ubuntu", "Cantarell", "Fira Sans", "Droid Sans", "Helvetica Neue", sans-serif; }
  .chart-container .axis,
  .chart-container .chart-label {
    fill: var(--charts-label-color); }
    .chart-container .axis line,
    .chart-container .chart-label line {
      stroke: var(--charts-axis-line-color); }
  .chart-container .dataset-units circle {
    stroke: var(--charts-dataset-circle-stroke);
    stroke-width: var(--charts-dataset-circle-stroke-width); }
  .chart-container .dataset-units path {
    fill: none;
    stroke-opacity: 1;
    stroke-width: var(--charts-stroke-width); }
  .chart-container .dataset-path {
    stroke-width: var(--charts-stroke-width); }
  .chart-container .path-group path {
    fill: none;
    stroke-opacity: 1;
    stroke-width: var(--charts-stroke-width); }
  .chart-container line.dashed {
    stroke-dasharray: 5, 3; }
  .chart-container .axis-line .specific-value {
    text-anchor: start; }
  .chart-container .axis-line .y-line {
    text-anchor: end; }
  .chart-container .axis-line .x-line {
    text-anchor: middle; }
  .chart-container .legend-dataset-label {
    fill: var(--charts-legend-label);
    font-weight: 600; }
  .chart-container .legend-dataset-value {
    fill: var(--charts-legend-value); }

.graph-svg-tip {
  position: absolute;
  z-index: 99999;
  padding: 10px;
  font-size: 12px;
  text-align: center;
  background: var(--charts-tooltip-bg);
  box-shadow: 0px 1px 4px rgba(17, 43, 66, 0.1), 0px 2px 6px rgba(17, 43, 66, 0.08), 0px 40px 30px -30px rgba(17, 43, 66, 0.1);
  border-radius: 6px; }
  .graph-svg-tip ul {
    padding-left: 0;
    display: flex; }
  .graph-svg-tip ol {
    padding-left: 0;
    display: flex; }
  .graph-svg-tip ul.data-point-list li {
    min-width: 90px;
    font-weight: 600; }
  .graph-svg-tip .svg-pointer {
    position: absolute;
    height: 12px;
    width: 12px;
    border-radius: 2px;
    background: var(--charts-tooltip-bg);
    transform: rotate(45deg);
    margin-top: -7px;
    margin-left: -6px; }
  .graph-svg-tip.comparison {
    text-align: left;
    padding: 0px;
    pointer-events: none; }
    .graph-svg-tip.comparison .title {
      display: block;
      padding: 16px;
      margin: 0;
      color: var(--charts-tooltip-title);
      font-weight: 600;
      line-height: 1;
      pointer-events: none;
      text-transform: uppercase; }
      .graph-svg-tip.comparison .title strong {
        color: var(--charts-tooltip-value); }
    .graph-svg-tip.comparison ul {
      margin: 0;
      white-space: nowrap;
      list-style: none; }
      .graph-svg-tip.comparison ul.tooltip-grid {
        display: grid;
        grid-template-columns: repeat(4, minmax(0, 1fr));
        gap: 5px; }
    .graph-svg-tip.comparison li {
      display: inline-block;
      display: flex;
      flex-direction: row;
      font-weight: 600;
      line-height: 1;
      padding: 5px 15px 15px 15px; }
      .graph-svg-tip.comparison li .tooltip-legend {
        height: 12px;
        width: 12px;
        margin-right: 8px;
        border-radius: 2px; }
      .graph-svg-tip.comparison li .tooltip-label {
        margin-top: 4px;
        font-size: 11px;
        line-height: 1.25;
        max-width: 150px;
        white-space: normal;
        color: var(--charts-tooltip-label); }
      .graph-svg-tip.comparison li .tooltip-value {
        color: var(--charts-tooltip-value); }
`),E.create=function(e,n){var a=document.createElement(e);for(var t in n){var i=n[t];if(t==="inside")E(i).appendChild(a);else if(t==="around"){var s=E(i);s.parentNode.insertBefore(a,s),a.appendChild(s)}else t==="styles"?Z(i)==="object"&&Object.keys(i).map(function(r){a.style[r]=i[r]}):t in a?a[t]=i:a.setAttribute(t,i)}return a};var Me={margins:{top:10,bottom:10,left:20,right:20},paddings:{top:20,bottom:40,left:30,right:10},baseHeight:240,titleHeight:20,legendHeight:30,titleFontSize:12};function Q(e){return e.titleHeight+e.margins.top+e.paddings.top}function X(e){return e.margins.left+e.paddings.left}function gt(e){return e.margins.top+e.margins.bottom+e.paddings.top+e.paddings.bottom+e.titleHeight+e.legendHeight}function ct(e){return e.margins.left+e.margins.right+e.paddings.left+e.paddings.right}var I=["pink","blue","green","grey","red","yellow","purple","teal","cyan","orange"],Se={bar:I,line:I,pie:I,percentage:I,heatmap:["#ebedf0","#c6e48b","#7bc96f","#239a3b","#196127"],donut:I},wt=Math.PI/180,Ee=function(){function e(n){var a=n.parent,t=a===void 0?null:a,i=n.colors,s=i===void 0?[]:i;P(this,e),this.parent=t,this.colors=s,this.titleName="",this.titleValue="",this.listValues=[],this.titleValueFirst=0,this.x=0,this.y=0,this.top=0,this.left=0,this.setup()}return S(e,[{key:"setup",value:function(){this.makeTooltip()}},{key:"refresh",value:function(){this.fill(),this.calcPosition()}},{key:"makeTooltip",value:function(){var n=this;this.container=E.create("div",{inside:this.parent,className:"graph-svg-tip comparison",innerHTML:`<span class="title"></span>
				<ul class="data-point-list"></ul>
				<div class="svg-pointer"></div>`}),this.hideTip(),this.title=this.container.querySelector(".title"),this.list=this.container.querySelector(".data-point-list"),this.dataPointList=this.container.querySelector(".data-point-list"),this.parent.addEventListener("mouseleave",function(){n.hideTip()})}},{key:"fill",value:function(){var n,a=this;this.index&&this.container.setAttribute("data-point-index",this.index),n=this.titleValueFirst?"<strong>".concat(this.titleValue,"</strong>").concat(this.titleName):"".concat(this.titleName,"<strong>").concat(this.titleValue,"</strong>"),this.listValues.length>4?this.list.classList.add("tooltip-grid"):this.list.classList.remove("tooltip-grid"),this.title.innerHTML=n,this.dataPointList.innerHTML="",this.listValues.map(function(t,i){var s=a.colors[i]||"black",r=t.formatted===0||t.formatted?t.formatted:t.value,o=E.create("li",{innerHTML:'<div class="tooltip-legend" style="background: '.concat(s,`;"></div>
					<div>
						<div class="tooltip-value">`).concat(r===0||r?r:"",`</div>
						<div class="tooltip-label">`).concat(t.title?t.title:"",`</div>
					</div>`)});a.dataPointList.appendChild(o)})}},{key:"calcPosition",value:function(){var n=this.container.offsetWidth;this.top=this.y-this.container.offsetHeight-7.48,this.left=this.x-n/2;var a=this.parent.offsetWidth-n,t=this.container.querySelector(".svg-pointer");if(this.left<0)t.style.left="calc(50% - ".concat(-1*this.left,"px)"),this.left=0;else if(this.left>a){var i=this.left-a,s="calc(50% + ".concat(i,"px)");t.style.left=s,this.left=a}else t.style.left="50%"}},{key:"setValues",value:function(n,a){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[],s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:-1;this.titleName=t.name,this.titleValue=t.value,this.listValues=i,this.x=n,this.y=a,this.titleValueFirst=t.valueFirst||0,this.index=s,this.refresh()}},{key:"hideTip",value:function(){this.container.style.top="0px",this.container.style.left="0px",this.container.style.opacity="0"}},{key:"showTip",value:function(){this.container.style.top=this.top+"px",this.container.style.left=this.left+"px",this.container.style.opacity="1"}}]),e}();function jt(e){return parseFloat(e.toFixed(2))}function ut(e,n,a){var t=arguments.length>3&&arguments[3]!==void 0&&arguments[3];a||(a=t?e[0]:e[e.length-1]);var i=new Array(Math.abs(n)).fill(a);return e=t?i.concat(e):e.concat(i)}function At(e,n){return(e+"").length*n}function it(e,n){return{x:Math.sin(e*wt)*n,y:Math.cos(e*wt)*n}}function N(e){var n=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return!Number.isNaN(e)&&e!==void 0&&!!Number.isFinite(e)&&!(n&&e<0)}function Wt(e){return Number(Math.round(e+"e4")+"e-4")}function ht(e){var n,a,t;if(e instanceof Date)return new Date(e.getTime());if(Z(e)!=="object"||e===null)return e;for(t in n=Array.isArray(e)?[]:{},e)a=e[t],n[t]=ht(a);return n}function Ct(e,n){var a,t;return e<=n?(a=n-e,t=e):(a=e-n,t=n),[a,t]}function C(e,n){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:n.length-e.length;return a>0?e=ut(e,a):n=ut(n,a),[e,n]}function Ne(e,n){if(e)return e.length>n?e.slice(0,n-3)+"...":e}function Oe(e){var n;if(typeof e=="number")n=e;else if(typeof e=="string"&&(n=Number(e),Number.isNaN(n)))return e;var a=Math.floor(Math.log10(Math.abs(n)));if(a<=2)return n;var t=Math.floor(a/3),i=Math.pow(10,a-3*t)*+(n/Math.pow(10,a)).toFixed(1);return Math.round(100*i)/100+["","K","M","B","T"][t]}function Dt(e,n){for(var a=[],t=(Math.min(e.length,n.length),0);t<e.length;t++)a.push([e[t],n[t]]);var i=function(s,r,o,l){var c,u,h,d,p=(c=r||s,h=(u=o||s)[0]-c[0],d=u[1]-c[1],{length:Math.sqrt(Math.pow(h,2)+Math.pow(d,2)),angle:Math.atan2(d,h)}),g=p.angle+(l?Math.PI:0),f=.2*p.length;return[s[0]+Math.cos(g)*f,s[1]+Math.sin(g)*f]};return function(s,r){return s.reduce(function(o,l,c,u){return c===0?"".concat(l[0],",").concat(l[1]):"".concat(o," ").concat(r(l,c,u))},"")}(a,function(s,r,o){var l=i(o[r-1],o[r-2],s),c=i(s,o[r-1],o[r+1],!0);return"C ".concat(l[0],",").concat(l[1]," ").concat(c[0],",").concat(c[1]," ").concat(s[0],",").concat(s[1])})}function Lt(e,n){return typeof e=="string"?(n||document).querySelector(e):e||null}function v(e,n){var a=document.createElementNS("http://www.w3.org/2000/svg",e);for(var t in n){var i=n[t];if(t==="inside")Lt(i).appendChild(a);else if(t==="around"){var s=Lt(i);s.parentNode.insertBefore(a,s),a.appendChild(s)}else t==="styles"?Z(i)==="object"&&Object.keys(i).map(function(r){a.style[r]=i[r]}):(t==="className"&&(t="class"),t==="innerHTML"?a.textContent=i:a.setAttribute(t,i))}return a}function Fe(e,n){return v("linearGradient",{inside:e,id:n,x1:0,x2:0,y1:0,y2:1})}function st(e,n,a,t){return v("stop",{inside:e,style:"stop-color: ".concat(a),offset:n,"stop-opacity":t})}function dt(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0,t={className:e,transform:n};return a&&(t.inside=a),v("g",t)}function R(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"none",t=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"none",i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:2;return v("path",{className:n,d:e,styles:{stroke:a,fill:t,"stroke-width":i}})}function $e(e,n,a,t){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1,s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:0,r=a.x+e.x,o=a.y+e.y,l=a.x+n.x,c=a.y+n.y;return"M".concat(a.x," ").concat(a.y,`
		L`).concat(r," ").concat(o,`
		A `).concat(t," ").concat(t," 0 ").concat(s," ").concat(i?1:0,`
		`).concat(l," ").concat(c," z")}function ze(e,n,a,t){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1,s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:0,r=a.x+e.x,o=a.y+e.y,l=a.x+n.x,c=2*a.y,u=a.y+n.y;return"M".concat(a.x," ").concat(a.y,`
		L`).concat(r," ").concat(o,`
		A `).concat(t," ").concat(t," 0 ").concat(s," ").concat(i?1:0,`
		`).concat(l," ").concat(c,` z
		L`).concat(r," ").concat(c,`
		A `).concat(t," ").concat(t," 0 ").concat(s," ").concat(i?1:0,`
		`).concat(l," ").concat(u," z")}function Re(e,n,a,t){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1,s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:0,r=a.x+e.x,o=a.y+e.y,l=a.x+n.x,c=a.y+n.y;return"M".concat(r," ").concat(o,`
		A `).concat(t," ").concat(t," 0 ").concat(s," ").concat(i?1:0,`
		`).concat(l," ").concat(c)}function He(e,n,a,t){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1,s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:0,r=a.x+e.x,o=a.y+e.y,l=a.x+n.x,c=2*t+o,u=a.y+e.y;return"M".concat(r," ").concat(o,`
		A `).concat(t," ").concat(t," 0 ").concat(s," ").concat(i?1:0,`
		`).concat(l," ").concat(c,`
		M`).concat(r," ").concat(c,`
		A `).concat(t," ").concat(t," 0 ").concat(s," ").concat(i?1:0,`
		`).concat(l," ").concat(u)}function Tt(e,n){var a=arguments.length>2&&arguments[2]!==void 0&&arguments[2],t="path-fill-gradient-"+n+"-"+(a?"lighter":"default"),i=Fe(e,t),s=[1,.6,.2];return a&&(s=[.15,.05,0]),st(i,"0%",n,s[0]),st(i,"50%",n,s[1]),st(i,"100%",n,s[2]),t}function je(e,n,a){var t=a/2,i=n-t;return"M".concat(e,",0 h").concat(i," q").concat(t,",0 ").concat(t,",").concat(t," q0,").concat(t," -").concat(t,",").concat(t," h-").concat(i," v").concat(a,"z")}function We(e,n,a){var t=a/2,i=n-t;return"M".concat(e+t,",0 h").concat(i," v").concat(a," h-").concat(i," q-").concat(t,", 0 -").concat(t,",-").concat(t," q0,-").concat(t," ").concat(t,",-").concat(t,"z")}function It(e,n,a,t,i){var s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:"none",r=arguments.length>6&&arguments[6]!==void 0?arguments[6]:{},o={className:e,x:n,y:a,width:t,height:t,rx:i,fill:s};return Object.keys(r).map(function(l){o[l]=r[l]}),v("rect",o)}function Bt(e,n,a,t){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"none",s=arguments.length>5?arguments[5]:void 0,r=arguments.length>6?arguments[6]:void 0,o=arguments.length>7&&arguments[7]!==void 0?arguments[7]:null,l=arguments.length>8&&arguments[8]!==void 0&&arguments[8];o||(o=10);var c={className:"legend-dot",x:0,y:4-a,height:a,width:a,rx:t,fill:i},u=v("text",{className:"legend-dataset-label",x:a,y:0,dx:o+"px",dy:o/3+"px","font-size":1.6*o+"px","text-anchor":"start",innerHTML:s=l?Ne(s,18):s}),h=null;r&&(h=v("text",{className:"legend-dataset-value",x:a,y:20,dx:"10px",dy:10/3+"px","font-size":"12px","text-anchor":"start",innerHTML:r}));var d=v("g",{transform:"translate(".concat(e,", ").concat(n,")")});return d.appendChild(v("rect",c)),d.appendChild(u),r&&h&&d.appendChild(h),d}function U(e,n,a,t){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{},s=i.fontSize||10,r=i.dy!==void 0?i.dy:s/2,o=i.fill||"var(--charts-label-color)",l=i.textAnchor||"start";return v("text",{className:e,x:n,y:a,dy:r+"px","font-size":s+"px",fill:o,"text-anchor":l,innerHTML:t})}function Ie(e,n,a,t){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{},s=v("line",{className:"line-vertical "+i.className,x1:0,x2:0,y1:a,y2:t,styles:{stroke:i.stroke}}),r=v("text",{x:0,y:a>t?a+4:a-4-10,dy:"10px","font-size":"10px","text-anchor":"middle",innerHTML:n+""}),o=v("g",{transform:"translate(".concat(e,", 0)")});return o.appendChild(s),o.appendChild(r),o}function Pt(e,n,a,t){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{};i.lineType||(i.lineType=""),i.shortenNumbers&&(n=i.numberFormatter?i.numberFormatter(n):Oe(n));var s="line-horizontal "+i.className+(i.lineType==="dashed"?"dashed":""),r=v("line",{className:s,x1:a,x2:t,y1:0,y2:0,styles:{stroke:i.stroke}}),o=v("text",{x:a<t?a-4:a+4,y:0,dy:"3px","font-size":"10px","text-anchor":a<t?"end":"start",innerHTML:n+""}),l=v("g",{transform:"translate(0, ".concat(e,")"),"stroke-opacity":1});return o!==0&&o!=="0"||(l.style.stroke="rgba(27, 31, 35, 0.6)"),l.appendChild(r),l.appendChild(o),l}function Mt(e,n,a,t){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"",s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:0,r=arguments.length>6&&arguments[6]!==void 0&&arguments[6],o=v("circle",{style:"fill: ".concat(t,"; ").concat(r?"stroke: ".concat(t):""),"data-point-index":s,cx:e,cy:n,r:a});if((i+="")||i.length){o.setAttribute("cy",0),o.setAttribute("cx",0);var l=v("text",{className:"data-point-value",x:0,y:0,dy:-5-a+"px","font-size":"10px","text-anchor":"middle",innerHTML:i}),c=v("g",{"data-point-index":s,transform:"translate(".concat(e,", ").concat(n,")")});return c.appendChild(o),c.appendChild(l),c}return o}var Be={bar:function(e){var n;e.nodeName!=="rect"&&(n=e.getAttribute("transform"),e=e.childNodes[0]);var a=e.cloneNode();return a.style.fill="#000000",a.style.opacity="0.4",n&&a.setAttribute("transform",n),a},dot:function(e){var n;e.nodeName!=="circle"&&(n=e.getAttribute("transform"),e=e.childNodes[0]);var a=e.cloneNode(),t=e.getAttribute("r"),i=e.getAttribute("fill");return a.setAttribute("r",parseInt(t)+4),a.setAttribute("fill",i),a.style.opacity="0.6",n&&a.setAttribute("transform",n),a},heat_square:function(e){var n;e.nodeName!=="circle"&&(n=e.getAttribute("transform"),e=e.childNodes[0]);var a=e.cloneNode(),t=e.getAttribute("r"),i=e.getAttribute("fill");return a.setAttribute("r",parseInt(t)+4),a.setAttribute("fill",i),a.style.opacity="0.6",n&&a.setAttribute("transform",n),a}},Ye={bar:function(e,n){var a;e.nodeName!=="rect"&&(a=e.getAttribute("transform"),e=e.childNodes[0]);var t=["x","y","width","height"];Object.values(e.attributes).filter(function(i){return t.includes(i.name)&&i.specified}).map(function(i){n.setAttribute(i.name,i.nodeValue)}),a&&n.setAttribute("transform",a)},dot:function(e,n){var a;e.nodeName!=="circle"&&(a=e.getAttribute("transform"),e=e.childNodes[0]);var t=["cx","cy"];Object.values(e.attributes).filter(function(i){return t.includes(i.name)&&i.specified}).map(function(i){n.setAttribute(i.name,i.nodeValue)}),a&&n.setAttribute("transform",a)},heat_square:function(e,n){var a;e.nodeName!=="circle"&&(a=e.getAttribute("transform"),e=e.childNodes[0]);var t=["cx","cy"];Object.values(e.attributes).filter(function(i){return t.includes(i.name)&&i.specified}).map(function(i){n.setAttribute(i.name,i.nodeValue)}),a&&n.setAttribute("transform",a)}},qe={pink:"#F683AE",blue:"#318AD8",green:"#48BB74",grey:"#A6B1B9",red:"#F56B6B",yellow:"#FACF7A",purple:"#44427B",teal:"#5FD8C4",cyan:"#15CCEF",orange:"#F8814F","light-pink":"#FED7E5","light-blue":"#BFDDF7","light-green":"#48BB74","light-grey":"#F4F5F6","light-red":"#F6DFDF","light-yellow":"#FEE9BF","light-purple":"#E8E8F7","light-teal":"#D3FDF6","light-cyan":"#DDF8FD","light-orange":"#FECDB8"};function Y(e,n,a,t){var i=typeof n=="string"?n:n.join(", ");return[e,{transform:a.join(", ")},t,"easein","translate",{transform:i}]}function St(e,n,a){return Y(e,[0,a],[0,n],350)}function Et(e,n){return[e,{d:n},350,"easein"]}var Ue={ease:"0.25 0.1 0.25 1",linear:"0 0 1 1",easein:"0.1 0.8 0.2 1",easeout:"0 0 0.58 1",easeinout:"0.42 0 0.58 1"};function Ge(e,n,a){var t=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"linear",i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:void 0,s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{},r=e.cloneNode(!0),o=e.cloneNode(!0);for(var l in n){var c=void 0;c=l==="transform"?document.createElementNS("http://www.w3.org/2000/svg","animateTransform"):document.createElementNS("http://www.w3.org/2000/svg","animate");var u=s[l]||e.getAttribute(l),h=n[l],d={attributeName:l,from:u,to:h,begin:"0s",dur:a/1e3+"s",values:u+";"+h,keySplines:Ue[t],keyTimes:"0;1",calcMode:"spline",fill:"freeze"};for(var p in i&&(d.type=i),d)c.setAttribute(p,d[p]);r.appendChild(c),i?o.setAttribute(l,"translate(".concat(h,")")):o.setAttribute(l,h)}return[r,o]}function pt(e,n){e.style.transform=n,e.style.webkitTransform=n,e.style.msTransform=n,e.style.mozTransform=n,e.style.oTransform=n}function Ve(e,n){var a=[],t=[];n.map(function(s){var r,o,l=s[0],c=l.parentNode;s[0]=l;var u=k(Ge.apply(void 0,T(s)),2);r=u[0],o=u[1],a.push(o),t.push([r,c]),c.replaceChild(r,l)});var i=e.cloneNode(!0);return t.map(function(s,r){s[1].replaceChild(a[r],s[0]),n[r][0]=a[r]}),i}function Ke(e,n,a){if(a.length!==0){var t=Ve(n,a);n.parentNode==e&&(e.removeChild(n),e.appendChild(t)),setTimeout(function(){t.parentNode==e&&(e.removeChild(t),e.appendChild(n))},250)}}var mt=function(){function e(n,a){if(P(this,e),a=ht(a),this.parent=typeof n=="string"?document.querySelector(n):n,!(this.parent instanceof HTMLElement))throw new Error("No `parent` element to render on was provided.");this.rawChartArgs=a,this.title=a.title||"",this.type=a.type||"",this.realData=this.prepareData(a.data),this.data=this.prepareFirstData(this.realData),this.colors=this.validateColors(a.colors,this.type),this.config={showTooltip:1,showLegend:a.showLegend!==void 0?a.showLegend:1,isNavigable:a.isNavigable||0,animate:a.animate!==void 0?a.animate:1,disableEntryAnimation:a.disableEntryAnimation||0,truncateLegends:a.truncateLegends||1},this.measures=JSON.parse(JSON.stringify(Me));var t=this.measures;this.setMeasures(a),this.title.length||(t.titleHeight=0),this.config.showLegend||(t.legendHeight=0),this.argHeight=a.height||t.baseHeight,this.state={},this.options={},this.initTimeout=700,this.config.isNavigable&&(this.overlays=[]),this.configure(a)}return S(e,[{key:"prepareData",value:function(n){return n}},{key:"prepareFirstData",value:function(n){return n}},{key:"validateColors",value:function(n,a){var t=[];return(n=(n||[]).concat(Se[a])).forEach(function(i){var s=function(r){return/rgb[a]{0,1}\([\d, ]+\)/gim.test(r)?/\D+(\d*)\D+(\d*)\D+(\d*)/gim.exec(r).map(function(o,l){return l!==0?Number(o).toString(16):"#"}).reduce(function(o,l){return"".concat(o).concat(l)}):qe[r]||r}(i);(function(r){return/(^\s*)(#)((?:[A-Fa-f0-9]{3}){1,2})$/i.test(r)||/(^\s*)(rgb|hsl)(a?)[(]\s*([\d.]+\s*%?)\s*,\s*([\d.]+\s*%?)\s*,\s*([\d.]+\s*%?)\s*(?:,\s*([\d.]+)\s*)?[)]$/i.test(r)})(s)?t.push(s):console.warn('"'+i+'" is not a valid color.')}),t}},{key:"setMeasures",value:function(){}},{key:"configure",value:function(){var n=this,a=this.argHeight;this.baseHeight=a,this.height=a-gt(this.measures),this.boundDrawFn=function(){return n.draw(!0)},ResizeObserver&&(this.resizeObserver=new ResizeObserver(this.boundDrawFn),this.resizeObserver.observe(this.parent)),window.addEventListener("resize",this.boundDrawFn),window.addEventListener("orientationchange",this.boundDrawFn)}},{key:"destroy",value:function(){this.resizeObserver&&this.resizeObserver.disconnect(),window.removeEventListener("resize",this.boundDrawFn),window.removeEventListener("orientationchange",this.boundDrawFn)}},{key:"setup",value:function(){this.makeContainer(),this.updateWidth(),this.makeTooltip(),this.draw(!1,!0)}},{key:"makeContainer",value:function(){this.parent.innerHTML="";var n={inside:this.parent,className:"chart-container"};this.independentWidth&&(n.styles={width:this.independentWidth+"px"}),this.container=E.create("div",n)}},{key:"makeTooltip",value:function(){this.tip=new Ee({parent:this.container,colors:this.colors}),this.bindTooltip()}},{key:"bindTooltip",value:function(){}},{key:"draw",value:function(){var n=this,a=arguments.length>0&&arguments[0]!==void 0&&arguments[0],t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];a&&Te(this.parent)||(this.updateWidth(),this.calc(a),this.makeChartArea(),this.setupComponents(),this.components.forEach(function(i){return i.setup(n.drawArea)}),this.render(this.components,!1),t&&(this.data=this.realData,setTimeout(function(){n.update(n.data,!0)},this.initTimeout)),this.config.showLegend&&this.renderLegend(),this.setupNavigation(t))}},{key:"calc",value:function(){}},{key:"updateWidth",value:function(){var n,a,t;this.baseWidth=(n=this.parent,a=window.getComputedStyle(n),t=parseFloat(a.paddingLeft)+parseFloat(a.paddingRight),n.clientWidth-t),this.width=this.baseWidth-ct(this.measures)}},{key:"makeChartArea",value:function(){this.svg&&this.container.removeChild(this.svg);var n,a,t,i,s=this.measures;this.svg=(n=this.container,a="frappe-chart chart",t=this.baseWidth,i=this.baseHeight,v("svg",{className:a,inside:n,width:t,height:i})),this.svgDefs=v("defs",{inside:this.svg}),this.title.length&&(this.titleEL=U("title",s.margins.left,s.margins.top,this.title,{fontSize:s.titleFontSize,fill:"#666666",dy:s.titleFontSize}));var r=Q(s);this.drawArea=dt(this.type+"-chart chart-draw-area","translate(".concat(X(s),", ").concat(r,")")),this.config.showLegend&&(r+=this.height+s.paddings.bottom,this.legendArea=dt("chart-legend","translate(".concat(X(s),", ").concat(r,")"))),this.title.length&&this.svg.appendChild(this.titleEL),this.svg.appendChild(this.drawArea),this.config.showLegend&&this.svg.appendChild(this.legendArea),this.updateTipOffset(X(s),Q(s))}},{key:"updateTipOffset",value:function(n,a){this.tip.offset={x:n,y:a}}},{key:"setupComponents",value:function(){this.components=new Map}},{key:"update",value:function(n){var a=arguments.length>1&&arguments[1]!==void 0&&arguments[1];n||console.error("No data to update."),a||(n=ht(n));var t=a?!this.config.disableEntryAnimation:this.config.animate;this.data=this.prepareData(n),this.calc(),this.render(this.components,t)}},{key:"render",value:function(){var n=this,a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.components,t=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];this.config.isNavigable&&this.overlays.map(function(s){return s.parentNode.removeChild(s)});var i=[];a.forEach(function(s){i=i.concat(s.update(t))}),i.length>0?(Ke(this.container,this.svg,i),setTimeout(function(){a.forEach(function(s){return s.make()}),n.updateNav()},400)):(a.forEach(function(s){return s.make()}),this.updateNav())}},{key:"updateNav",value:function(){this.config.isNavigable&&(this.makeOverlay(),this.bindUnits())}},{key:"renderLegend",value:function(n){var a=this;this.legendArea.textContent="";var t=0,i=0;n.map(function(s,r){var o=Math.floor(a.width/150);t>o&&(t=0,i+=a.config.legendRowHeight);var l=150*t,c=a.makeLegend(s,r,l,i);a.legendArea.appendChild(c),t++})}},{key:"makeLegend",value:function(){}},{key:"setupNavigation",value:function(){var n=this,a=arguments.length>0&&arguments[0]!==void 0&&arguments[0];this.config.isNavigable&&a&&(this.bindOverlay(),this.keyActions={13:this.onEnterKey.bind(this),37:this.onLeftArrow.bind(this),38:this.onUpArrow.bind(this),39:this.onRightArrow.bind(this),40:this.onDownArrow.bind(this)},document.addEventListener("keydown",function(t){Pe(n.container)&&(t=t||window.event,n.keyActions[t.keyCode]&&n.keyActions[t.keyCode]())}))}},{key:"makeOverlay",value:function(){}},{key:"updateOverlay",value:function(){}},{key:"bindOverlay",value:function(){}},{key:"bindUnits",value:function(){}},{key:"onLeftArrow",value:function(){}},{key:"onRightArrow",value:function(){}},{key:"onUpArrow",value:function(){}},{key:"onDownArrow",value:function(){}},{key:"onEnterKey",value:function(){}},{key:"addDataPoint",value:function(){}},{key:"removeDataPoint",value:function(){}},{key:"getDataPoint",value:function(){}},{key:"setCurrentDataPoint",value:function(){}},{key:"updateDataset",value:function(){}},{key:"export",value:function(){var n=function(a){var t=a.cloneNode(!0);t.classList.add("chart-container"),t.setAttribute("xmlns","http://www.w3.org/2000/svg"),t.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink");var i=E.create("style",{innerHTML:".chart-container{position:relative;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI','Roboto','Oxygen','Ubuntu','Cantarell','Fira Sans','Droid Sans','Helvetica Neue',sans-serif}.chart-container .axis,.chart-container .chart-label{fill:#555b51}.chart-container .axis line,.chart-container .chart-label line{stroke:#dadada}.chart-container .dataset-units circle{stroke:#fff;stroke-width:2}.chart-container .dataset-units path{fill:none;stroke-opacity:1;stroke-width:2px}.chart-container .dataset-path{stroke-width:2px}.chart-container .path-group path{fill:none;stroke-opacity:1;stroke-width:2px}.chart-container line.dashed{stroke-dasharray:5,3}.chart-container .axis-line .specific-value{text-anchor:start}.chart-container .axis-line .y-line{text-anchor:end}.chart-container .axis-line .x-line{text-anchor:middle}.chart-container .legend-dataset-text{fill:#6c7680;font-weight:600}.graph-svg-tip{position:absolute;z-index:99999;padding:10px;font-size:12px;color:#959da5;text-align:center;background:rgba(0,0,0,.8);border-radius:3px}.graph-svg-tip ul{padding-left:0;display:flex}.graph-svg-tip ol{padding-left:0;display:flex}.graph-svg-tip ul.data-point-list li{min-width:90px;flex:1;font-weight:600}.graph-svg-tip strong{color:#dfe2e5;font-weight:600}.graph-svg-tip .svg-pointer{position:absolute;height:5px;margin:0 0 0 -5px;content:' ';border:5px solid transparent;}.graph-svg-tip.comparison{padding:0;text-align:left;pointer-events:none}.graph-svg-tip.comparison .title{display:block;padding:10px;margin:0;font-weight:600;line-height:1;pointer-events:none}.graph-svg-tip.comparison ul{margin:0;white-space:nowrap;list-style:none}.graph-svg-tip.comparison li{display:inline-block;padding:5px 10px}"});t.insertBefore(i,t.firstChild);var s=E.create("div");return s.appendChild(t),s.innerHTML}(this.svg);(function(a,t){var i=document.createElement("a");i.style="display: none";var s=new Blob(t,{type:"image/svg+xml; charset=utf-8"}),r=window.URL.createObjectURL(s);i.href=r,i.download=a,document.body.appendChild(i),i.click(),setTimeout(function(){document.body.removeChild(i),window.URL.revokeObjectURL(r)},300)})(this.title||"Chart",[n])}}]),e}(),Yt=function(e){j(a,mt);var n=W(a);function a(t,i){return P(this,a),n.call(this,t,i)}return S(a,[{key:"configure",value:function(t){L(w(a.prototype),"configure",this).call(this,t),this.config.formatTooltipY=(t.tooltipOptions||{}).formatTooltipY,this.config.maxSlices=t.maxSlices||20,this.config.maxLegendPoints=t.maxLegendPoints||20,this.config.legendRowHeight=60}},{key:"calc",value:function(){var t=this,i=this.state,s=this.config.maxSlices;i.sliceTotals=[];var r=this.data.labels.map(function(u,h){var d=0;return t.data.datasets.map(function(p){d+=p.values[h]}),[d,u]}).filter(function(u){return u[0]>=0}),o=r;if(r.length>s){r.sort(function(u,h){return h[0]-u[0]}),o=r.slice(0,s-1);var l=r.slice(s-1),c=0;l.map(function(u){c+=u[0]}),o.push([c,"Rest"]),this.colors[s-1]="grey"}i.labels=[],o.map(function(u){i.sliceTotals.push(Wt(u[0])),i.labels.push(u[1])}),i.grandTotal=i.sliceTotals.reduce(function(u,h){return u+h},0),this.center={x:this.width/2,y:this.height/2}}},{key:"renderLegend",value:function(){var t=this.state;this.legendArea.textContent="",this.legendTotals=t.sliceTotals.slice(0,this.config.maxLegendPoints),L(w(a.prototype),"renderLegend",this).call(this,this.legendTotals)}},{key:"makeLegend",value:function(t,i,s,r){var o=this.config.formatTooltipY?this.config.formatTooltipY(t):t;return Bt(s,r,12,3,this.colors[i],this.state.labels[i],o,null,this.config.truncateLegends)}}]),a}(),Xe=["January","February","March","April","May","June","July","August","September","October","November","December"],Je=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];function Nt(e){var n=new Date(e);return n.setMinutes(n.getMinutes()-n.getTimezoneOffset()),n}function rt(e){var n=e.getDate(),a=e.getMonth()+1;return[e.getFullYear(),(a>9?"":"0")+a,(n>9?"":"0")+n].join("-")}function O(e){return new Date(e.getTime())}function ot(e,n){var a=Ut(e);return Math.ceil(function(t,i){return(Nt(i)-Nt(t))/864e5}(a,n)/7)}function Qe(e,n){return e.getMonth()===n.getMonth()&&e.getFullYear()===n.getFullYear()}function qt(e){var n=arguments.length>1&&arguments[1]!==void 0&&arguments[1],a=Xe[e];return n?a.slice(0,3):a}function Ot(e,n){return new Date(n,e+1,0)}function Ut(e){var n=O(e),a=n.getDay();return a!==0&&H(n,-1*a),n}function H(e,n){e.setDate(e.getDate()+n)}var Ze=function(){function e(n){var a=n.layerClass,t=a===void 0?"":a,i=n.layerTransform,s=i===void 0?"":i,r=n.constants,o=n.getData,l=n.makeElements,c=n.animateElements;P(this,e),this.layerTransform=s,this.constants=r,this.makeElements=l,this.getData=o,this.animateElements=c,this.store=[],this.labels=[],this.layerClass=t,this.layerClass=typeof this.layerClass=="function"?this.layerClass():this.layerClass,this.refresh()}return S(e,[{key:"refresh",value:function(n){this.data=n||this.getData()}},{key:"setup",value:function(n){this.layer=dt(this.layerClass,this.layerTransform,n)}},{key:"make",value:function(){this.render(this.data),this.oldData=this.data}},{key:"render",value:function(n){var a=this;this.store=this.makeElements(n),this.layer.textContent="",this.store.forEach(function(t){a.layer.appendChild(t)}),this.labels.forEach(function(t){a.layer.appendChild(t)})}},{key:"update",value:function(){var n=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];this.refresh();var a=[];return n&&(a=this.animateElements(this.data)||[]),a}}]),e}(),Ft={donutSlices:{layerClass:"donut-slices",makeElements:function(e){return e.sliceStrings.map(function(n,a){var t=R(n,"donut-path",e.colors[a],"none",e.strokeWidth);return t.style.transition="transform .3s;",t})},animateElements:function(e){return this.store.map(function(n,a){return Et(n,e.sliceStrings[a])})}},pieSlices:{layerClass:"pie-slices",makeElements:function(e){return e.sliceStrings.map(function(n,a){var t=R(n,"pie-path","none",e.colors[a]);return t.style.transition="transform .3s;",t})},animateElements:function(e){return this.store.map(function(n,a){return Et(n,e.sliceStrings[a])})}},percentageBars:{layerClass:"percentage-bars",makeElements:function(e){var n=this,a=e.xPositions.length;return e.xPositions.map(function(t,i){var s=i==a-1,r=i==0;return function(o,l,c,u,h,d){var p=arguments.length>6&&arguments[6]!==void 0?arguments[6]:"none";if(d){var g=je(o,c,u);return R(g,"percentage-bar",null,p)}if(h){var f=We(o,c,u);return R(f,"percentage-bar",null,p)}var m={className:"percentage-bar",x:o,y:l,width:c,height:u,fill:p};return v("rect",m)}(t,0,e.widths[i],n.constants.barHeight,r,s,e.colors[i])})},animateElements:function(e){if(e)return[]}},yAxis:{layerClass:"y axis",makeElements:function(e){var n=this;return e.positions.map(function(a,t){return function(i,s,r){var o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};N(i)||(i=0),o.pos||(o.pos="left"),o.offset||(o.offset=0),o.mode||(o.mode="span"),o.stroke||(o.stroke="#E2E6E9"),o.className||(o.className="");var l=-6,c=o.mode==="span"?r+6:0;return o.mode==="tick"&&o.pos==="right"&&(l=r+6,c=r),l+=o.offset,c+=o.offset,typeof s=="number"&&(s=Wt(s)),Pt(i,s,l,c,{className:o.className,lineType:o.lineType,shortenNumbers:o.shortenNumbers,numberFormatter:o.numberFormatter})}(a,e.labels[t],n.constants.width,{mode:n.constants.mode,pos:n.constants.pos,shortenNumbers:n.constants.shortenNumbers,numberFormatter:n.constants.numberFormatter})})},animateElements:function(e){var n=e.positions,a=e.labels,t=this.oldData.positions,i=this.oldData.labels,s=k(C(t,n),2);t=s[0],n=s[1];var r=k(C(i,a),2);return i=r[0],a=r[1],this.render({positions:t,labels:a}),this.store.map(function(o,l){return St(o,n[l],t[l])})}},xAxis:{layerClass:"x axis",makeElements:function(e){var n=this;return e.positions.map(function(a,t){return function(i,s,r){var o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};N(i)||(i=0),o.pos||(o.pos="bottom"),o.offset||(o.offset=0),o.mode||(o.mode="span"),o.className||(o.className="");var l=r+6,c=o.mode==="span"?-6:r;return o.mode==="tick"&&o.pos==="top"&&(l=-6,c=0),Ie(i,s,l,c,{className:o.className,lineType:o.lineType})}(a,e.calcLabels[t],n.constants.height,{mode:n.constants.mode,pos:n.constants.pos})})},animateElements:function(e){var n=e.positions,a=e.calcLabels,t=this.oldData.positions,i=this.oldData.calcLabels,s=k(C(t,n),2);t=s[0],n=s[1];var r=k(C(i,a),2);return i=r[0],a=r[1],this.render({positions:t,calcLabels:a}),this.store.map(function(o,l){return function(c,u,h){return Y(c,[h,0],[u,0],350)}(o,n[l],t[l])})}},yMarkers:{layerClass:"y-markers",makeElements:function(e){var n=this;return e.map(function(a){return function(t,i,s){var r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};N(t)||(t=0),r.labelPos||(r.labelPos="right"),r.lineType||(r.lineType="dashed");var o=r.labelPos==="left"?4:s-At(i,5)-4,l=v("text",{className:"chart-label",x:o,y:0,dy:"-5px","font-size":"10px","text-anchor":"start",innerHTML:i+""}),c=Pt(t,"",0,s,{stroke:r.stroke||"#E2E6E9",className:r.className||"",lineType:r.lineType});return c.appendChild(l),c}(a.position,a.label,n.constants.width,{labelPos:a.options.labelPos,stroke:a.options.stroke,mode:"span",lineType:a.options.lineType})})},animateElements:function(e){var n=k(C(this.oldData,e),2);this.oldData=n[0];var a=(e=n[1]).map(function(r){return r.position}),t=e.map(function(r){return r.label}),i=e.map(function(r){return r.options}),s=this.oldData.map(function(r){return r.position});return this.render(s.map(function(r,o){return{position:s[o],label:t[o],options:i[o]}})),this.store.map(function(r,o){return St(r,a[o],s[o])})}},yRegions:{layerClass:"y-regions",makeElements:function(e){var n=this;return e.map(function(a){return function(t,i,s,r){var o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{},l=t-i,c=v("rect",{className:"bar mini",styles:{fill:o.fill||"rgba(228, 234, 239, 0.49)",stroke:o.stroke||"#E2E6E9","stroke-dasharray":"".concat(s,", ").concat(l)},x:0,y:0,width:s,height:l});o.labelPos||(o.labelPos="right");var u=o.labelPos==="left"?4:s-At(r+"",4.5)-4,h=v("text",{className:"chart-label",x:u,y:0,dy:"-5px","font-size":"10px","text-anchor":"start",innerHTML:r+""}),d=v("g",{transform:"translate(0, ".concat(i,")")});return d.appendChild(c),d.appendChild(h),d}(a.startPos,a.endPos,n.constants.width,a.label,{labelPos:a.options.labelPos,stroke:a.options.stroke,fill:a.options.fill})})},animateElements:function(e){var n=k(C(this.oldData,e),2);this.oldData=n[0];var a=(e=n[1]).map(function(c){return c.endPos}),t=e.map(function(c){return c.label}),i=e.map(function(c){return c.startPos}),s=e.map(function(c){return c.options}),r=this.oldData.map(function(c){return c.endPos}),o=this.oldData.map(function(c){return c.startPos});this.render(r.map(function(c,u){return{startPos:o[u],endPos:r[u],label:t[u],options:s[u]}}));var l=[];return this.store.map(function(c,u){l=l.concat(function(h,d,p,g){var f=d-p,m=h.childNodes[0],y=m.getAttribute("width");return[[m,{height:f,"stroke-dasharray":"".concat(y,", ").concat(f)},350,"easein"],Y(h,[0,g],[0,p],350)]}(c,i[u],a[u],r[u]))}),l}},heatDomain:{layerClass:function(){return"heat-domain domain-"+this.constants.index},makeElements:function(e){var n=this,a=this.constants,t=a.index,i=a.colWidth,s=a.rowHeight,r=a.squareSize,o=a.radius,l=a.xTranslate,c=l,u=0;return this.serializedSubDomains=[],e.cols.map(function(h,d){d===1&&n.labels.push(U("domain-name",c,-12,qt(t,!0).toUpperCase(),{fontSize:9})),h.map(function(p,g){if(p.fill){var f={"data-date":p.yyyyMmDd,"data-value":p.dataValue,"data-day":g},m=It("day",c,u,r,o,p.fill,f);n.serializedSubDomains.push(m)}u+=s}),u=0,c+=i}),this.serializedSubDomains},animateElements:function(e){if(e)return[]}},barGraph:{layerClass:function(){return"dataset-units dataset-bars dataset-"+this.constants.index},makeElements:function(e){var n=this.constants;return this.unitType="bar",this.units=e.yPositions.map(function(a,t){return function(i,s,r,o){var l=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"",c=arguments.length>5&&arguments[5]!==void 0?arguments[5]:0,u=arguments.length>6&&arguments[6]!==void 0?arguments[6]:0,h=arguments.length>7&&arguments[7]!==void 0?arguments[7]:{},d=Ct(s,h.zeroLine),p=k(d,2),g=p[0],f=p[1];f-=u,g===0&&(g=h.minHeight,f-=h.minHeight),N(i)||(i=0),N(f)||(f=0),N(g,!0)||(g=0),N(r,!0)||(r=0);var m=v("rect",{className:"bar mini",style:"fill: ".concat(o),"data-point-index":c,x:i,y:f,width:r,height:g});if((l+="")||l.length){m.setAttribute("y",0),m.setAttribute("x",0);var y=v("text",{className:"data-point-value",x:r/2,y:0,dy:"-5px","font-size":"10px","text-anchor":"middle",innerHTML:l}),x=v("g",{"data-point-index":c,transform:"translate(".concat(i,", ").concat(f,")")});return x.appendChild(m),x.appendChild(y),x}return m}(e.xPositions[t],a,e.barWidth,n.color,e.labels[t],t,e.offsets[t],{zeroLine:e.zeroLine,barsWidth:e.barsWidth,minHeight:n.minHeight})}),this.units},animateElements:function(e){var n=e.xPositions,a=e.yPositions,t=e.offsets,i=e.labels,s=this.oldData.xPositions,r=this.oldData.yPositions,o=this.oldData.offsets,l=this.oldData.labels,c=k(C(s,n),2);s=c[0],n=c[1];var u=k(C(r,a),2);r=u[0],a=u[1];var h=k(C(o,t),2);o=h[0],t=h[1];var d=k(C(l,i),2);l=d[0],i=d[1],this.render({xPositions:s,yPositions:r,offsets:o,labels:i,zeroLine:this.oldData.zeroLine,barsWidth:this.oldData.barsWidth,barWidth:this.oldData.barWidth});var p=[];return this.store.map(function(g,f){p=p.concat(function(m,y,x,A){var b=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0,D=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{},M=Ct(x,D.zeroLine),z=k(M,2),yt=z[0],et=z[1];if(et-=b,m.nodeName!=="rect"){var Qt=m.childNodes[0],Zt=[Qt,{width:A,height:yt},350,"easein"],te=m.getAttribute("transform").split("(")[1].slice(0,-1),ee=Y(m,te,[y,et],350);return[Zt,ee]}return[[m,{width:A,height:yt,x:y,y:et},350,"easein"]]}(g,n[f],a[f],e.barWidth,t[f],{zeroLine:e.zeroLine}))}),p}},lineGraph:{layerClass:function(){return"dataset-units dataset-line dataset-"+this.constants.index},makeElements:function(e){var n=this.constants;if(this.unitType="dot",this.paths={},n.hideLine||(this.paths=function(i,s,r){var o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},l=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{},c=s.map(function(m,y){return i[y]+","+m}),u=c.join("L");o.spline&&(u=Dt(i,s));var h=R("M"+u,"line-graph-path",r);if(o.heatline){var d=Tt(l.svgDefs,r);h.style.stroke="url(#".concat(d,")")}var p={path:h};if(o.regionFill){var g=Tt(l.svgDefs,r,!0),f="M"+"".concat(i[0],",").concat(l.zeroLine,"L")+u+"L".concat(i.slice(-1)[0],",").concat(l.zeroLine);p.region=R(f,"region-fill","none","url(#".concat(g,")"))}return p}(e.xPositions,e.yPositions,n.color,{heatline:n.heatline,regionFill:n.regionFill,spline:n.spline},{svgDefs:n.svgDefs,zeroLine:e.zeroLine})),this.units=[],n.showDots&&(this.units=e.yPositions.map(function(i,s){return Mt(e.xPositions[s],i,e.radius,n.color,n.valuesOverPoints?e.values[s]:"",s,n.hideDotBorder)})),n.trailingDot&&!n.showDots){var a=e.yPositions.length-1,t=Mt(e.xPositions[a],e.yPositions[a],e.radius,n.color,n.valuesOverPoints?e.values[a]:"",a,n.hideDotBorder);this.units.push(t)}return Object.values(this.paths).concat(this.units)},animateElements:function(e){var n=e.xPositions,a=e.yPositions,t=e.values,i=this.oldData.xPositions,s=this.oldData.yPositions,r=this.oldData.values,o=k(C(i,n),2);i=o[0],n=o[1];var l=k(C(s,a),2);s=l[0],a=l[1];var c=k(C(r,t),2);r=c[0],t=c[1],this.render({xPositions:i,yPositions:s,values:t,zeroLine:this.oldData.zeroLine,radius:this.oldData.radius});var u=[];return Object.keys(this.paths).length&&(u=u.concat(function(h,d,p,g,f){var m=[],y=p.map(function(M,z){return d[z]+","+M}).join("L");f&&(y=Dt(d,p));var x=[h.path,{d:"M"+y},350,"easein"];if(m.push(x),h.region){var A="".concat(d[0],",").concat(g,"L"),b="L".concat(d.slice(-1)[0],", ").concat(g),D=[h.region,{d:"M"+A+y+b},350,"easein"];m.push(D)}return m}(this.paths,n,a,e.zeroLine,this.constants.spline))),this.units.length&&this.units.map(function(h,d){u=u.concat(function(p,g,f){if(p.nodeName!=="circle"){var m=p.getAttribute("transform").split("(")[1].slice(0,-1);return[Y(p,m,[g,f],350)]}return[[p,{cx:g,cy:f},350,"easein"]]}(h,n[d],a[d]))}),u}}};function G(e,n,a){var t=Object.keys(Ft).filter(function(s){return e.includes(s)}),i=Ft[t[0]];return Object.assign(i,{constants:n,getData:a}),new Ze(i)}var tn=function(e){j(a,Yt);var n=W(a);function a(t,i){var s;return P(this,a),(s=n.call(this,t,i)).type="percentage",s.setup(),s}return S(a,[{key:"setMeasures",value:function(t){var i=this.measures;this.barOptions=t.barOptions||{};var s=this.barOptions;s.height=s.height||16,i.paddings.right=30,i.paddings.top=60,i.paddings.bottom=0,i.legendHeight=80,i.baseHeight=8*s.height+gt(i)}},{key:"setupComponents",value:function(){var t=this.state,i=[["percentageBars",{barHeight:this.barOptions.height},function(){return{xPositions:t.xPositions,widths:t.widths,colors:this.colors}}.bind(this)]];this.components=new Map(i.map(function(s){var r=G.apply(void 0,T(s));return[s[0],r]}))}},{key:"calc",value:function(){var t=this;L(w(a.prototype),"calc",this).call(this);var i=this.state;i.xPositions=[],i.widths=[];var s=0;i.sliceTotals.map(function(r){var o=t.width*r/i.grandTotal;i.widths.push(o),i.xPositions.push(s),s+=o})}},{key:"makeDataByIndex",value:function(){}},{key:"bindTooltip",value:function(){var t=this,i=this.state;this.container.addEventListener("mousemove",function(s){var r=t.components.get("percentageBars").store,o=s.target;if(r.includes(o)){var l=r.indexOf(o),c=J(t.container),u=J(o),h=o.getAttribute("width")||o.getBoundingClientRect().width,d=u.left-c.left+parseInt(h)/2,p=u.top-c.top,g=(t.formattedLabels&&t.formattedLabels.length>0?t.formattedLabels[l]:t.state.labels[l])+": ",f=i.sliceTotals[l]/i.grandTotal;t.tip.setValues(d,p,{name:g,value:(100*f).toFixed(1)+"%"}),t.tip.showTip()}})}}]),a}(),$t=function(e){j(a,Yt);var n=W(a);function a(t,i){var s;return P(this,a),(s=n.call(this,t,i)).initTimeout=0,s.init=1,s.setup(),s}return S(a,[{key:"configure",value:function(t){L(w(a.prototype),"configure",this).call(this,t),this.mouseMove=this.mouseMove.bind(this),this.mouseLeave=this.mouseLeave.bind(this),this.hoverRadio=t.hoverRadio||.1,this.config.startAngle=t.startAngle||0,this.type="pie",this.sliceName="pieSlices",this.arcFunc=$e,this.shapeFunc=ze,this.clockWise=t.clockWise||!1}},{key:"getRadius",value:function(){return this.height>this.width?this.center.x:this.center.y}},{key:"calc",value:function(){var t=this;L(w(a.prototype),"calc",this).call(this);var i=this.state;this.radius=this.getRadius();var s=this.radius,r=this.clockWise,o=i.slicesProperties||[];i.sliceStrings=[],i.slicesProperties=[];var l=180-this.config.startAngle;i.sliceTotals.map(function(c,u){var h,d,p=l,g=c/i.grandTotal*360,f=g>180?1:0,m=r?-g:g,y=l+=m,x=it(p,s),A=it(y,s),b=t.init&&o[u];t.init?(h=b?b.startPosition:x,d=b?b.endPosition:x):(h=x,d=A);var D=g===360?t.shapeFunc(h,d,t.center,t.radius,r,f):t.arcFunc(h,d,t.center,t.radius,r,f);i.sliceStrings.push(D),i.slicesProperties.push({startPosition:x,endPosition:A,value:c,total:i.grandTotal,startAngle:p,endAngle:y,angle:m})}),this.init=0}},{key:"setupComponents",value:function(){var t=this.state,i=[["pieSlices",{},function(){return{sliceStrings:t.sliceStrings,colors:this.colors}}.bind(this)]];this.components=new Map(i.map(function(s){var r=G.apply(void 0,T(s));return[s[0],r]}))}},{key:"calTranslateByAngle",value:function(t){var i=this.radius,s=this.hoverRadio,r=it(t.startAngle+t.angle/2,i);return"translate3d(".concat(r.x*s,"px,").concat(r.y*s,"px,0)")}},{key:"hoverSlice",value:function(t,i,s,r){if(t){var o=this.colors[i];if(s){pt(t,this.calTranslateByAngle(this.state.slicesProperties[i]));var l=J(this.svg),c=r.pageX-l.left+10,u=r.pageY-l.top-10,h=(this.formatted_labels&&this.formatted_labels.length>0?this.formatted_labels[i]:this.state.labels[i])+": ",d=(100*this.state.sliceTotals[i]/this.state.grandTotal).toFixed(1);this.tip.setValues(c,u,{name:h,value:d+"%"}),this.tip.showTip()}else this.resetHover(t,o)}}},{key:"resetHover",value:function(t,i){pt(t,"translate3d(0,0,0)"),this.tip.hideTip(),t.style.fill=i}},{key:"bindTooltip",value:function(){this.container.addEventListener("mousemove",this.mouseMove),this.container.addEventListener("mouseleave",this.mouseLeave)}},{key:"mouseMove",value:function(t){var i=t.target,s=this.components.get(this.sliceName).store,r=this.curActiveSliceIndex,o=this.curActiveSlice;if(s.includes(i)){var l=s.indexOf(i);this.hoverSlice(o,r,!1),this.curActiveSlice=i,this.curActiveSliceIndex=l,this.hoverSlice(i,l,!0,t)}else this.mouseLeave()}},{key:"mouseLeave",value:function(){this.hoverSlice(this.curActiveSlice,this.curActiveSliceIndex,!1)}}]),a}();function q(e){if(e===0)return[0,0];if(isNaN(e))return{mantissa:-6755399441055744,exponent:972};var n=e>0?1:-1;if(!isFinite(e))return{mantissa:4503599627370496*n,exponent:972};e=Math.abs(e);var a=Math.floor(Math.log10(e));return[n*(e/Math.pow(10,a)),a]}function en(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=Math.ceil(e),t=Math.floor(n),i=a-t,s=i,r=1;i>5&&(i%2!=0&&(i=++a-t),s=i/2,r=2),i<=2&&(r=i/(s=4)),i===0&&(s=5,r=1);for(var o=[],l=0;l<=s;l++)o.push(t+r*l);return o}function B(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=q(e),t=k(a,2),i=t[0],s=t[1],r=n?n/Math.pow(10,s):0,o=en(i=i.toFixed(6),r);return o=o.map(function(l){return l*Math.pow(10,s)})}function nn(e){var n=arguments.length>1&&arguments[1]!==void 0&&arguments[1],a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},t=Math.max.apply(Math,T(e)),i=Math.min.apply(Math,T(e));a.max!==void 0&&(t=t>a.max?t:a.max),a.min!==void 0&&(i=i<a.min?i:a.min);var s=[];function r(h,d){for(var p=B(h),g=p[1]-p[0],f=0,m=1;f<d;m++)f+=g,p.unshift(-1*f);return p}if(t>=0&&i>=0)q(t)[1],s=n?B(t,i):B(t);else if(t>0&&i<0){var o=Math.abs(i);if(t>=o)q(t)[1],s=r(t,o);else{q(o)[1];var l=r(o,t);s=l.reverse().map(function(h){return-1*h})}}else if(t<=0&&i<=0){var c=Math.abs(i),u=Math.abs(t);q(c)[1],s=(s=n?B(c,u):B(c)).reverse().map(function(h){return-1*h})}return s}function an(e){var n,a=Gt(e);return e.indexOf(0)>=0?n=e.indexOf(0):e[0]>0?n=-1*e[0]/a:n=-1*e[e.length-1]/a+(e.length-1),n}function Gt(e){return e[1]-e[0]}function sn(e){return e[e.length-1]-e[0]}function K(e,n){return jt(n.zeroLine-e*n.scaleMultiplier)}var rn=function(e){j(a,mt);var n=W(a);function a(t,i){var s;P(this,a),(s=n.call(this,t,i)).type="heatmap",s.countLabel=i.countLabel||"";var r=["Sunday","Monday"],o=r.includes(i.startSubDomain)?i.startSubDomain:"Sunday";return s.startSubDomainIndex=r.indexOf(o),s.setup(),s}return S(a,[{key:"setMeasures",value:function(t){var i=this.measures;this.discreteDomains=t.discreteDomains===0?0:1,i.paddings.top=36,i.paddings.bottom=0,i.legendHeight=24,i.baseHeight=84+gt(i);var s=this.data,r=this.discreteDomains?12:0;this.independentWidth=12*(ot(s.start,s.end)+r)+ct(i)}},{key:"updateWidth",value:function(){var t=this.discreteDomains?12:0,i=this.state.noOfWeeks?this.state.noOfWeeks:52;this.baseWidth=12*(i+t)+ct(this.measures)}},{key:"prepareData",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.data;if(t.start&&t.end&&t.start>t.end)throw new Error("Start date cannot be greater than end date.");if(t.start||(t.start=new Date,t.start.setFullYear(t.start.getFullYear()-1)),t.end||(t.end=new Date),t.dataPoints=t.dataPoints||{},parseInt(Object.keys(t.dataPoints)[0])>1e5){var i={};Object.keys(t.dataPoints).forEach(function(s){var r=new Date(1e3*s);i[rt(r)]=t.dataPoints[s]}),t.dataPoints=i}return t}},{key:"calc",value:function(){var t=this.state;t.start=O(this.data.start),t.end=O(this.data.end),t.firstWeekStart=O(t.start),t.noOfWeeks=ot(t.start,t.end),t.distribution=function(i,s){for(var r=Math.max.apply(Math,T(i)),o=1/(s-1),l=[],c=0;c<s;c++){var u=r*(o*c);l.push(u)}return l}(Object.values(this.data.dataPoints),5),t.domainConfigs=this.getDomains()}},{key:"setupComponents",value:function(){var t=this,i=this.state,s=this.discreteDomains?0:1,r=i.domainConfigs.map(function(l,c){return["heatDomain",{index:l.index,colWidth:12,rowHeight:12,squareSize:10,radius:t.rawChartArgs.radius||0,xTranslate:12*i.domainConfigs.filter(function(u,h){return h<c}).map(function(u){return u.cols.length-s}).reduce(function(u,h){return u+h},0)},function(){return i.domainConfigs[c]}.bind(t)]});this.components=new Map(r.map(function(l,c){var u=G.apply(void 0,T(l));return[l[0]+"-"+c,u]}));var o=0;Je.forEach(function(l,c){if([1,3,5].includes(c)){var u=U("subdomain-name",-6,o,l,{fontSize:10,dy:8,textAnchor:"end"});t.drawArea.appendChild(u)}o+=12})}},{key:"update",value:function(t){t||console.error("No data to update."),this.data=this.prepareData(t),this.draw(),this.bindTooltip()}},{key:"bindTooltip",value:function(){var t=this;this.container.addEventListener("mousemove",function(i){t.components.forEach(function(s){var r=s.store,o=i.target;if(r.includes(o)){var l=o.getAttribute("data-value"),c=o.getAttribute("data-date").split("-"),u=qt(parseInt(c[1])-1,!0),h=t.container.getBoundingClientRect(),d=o.getBoundingClientRect(),p=parseInt(i.target.getAttribute("width")),g=d.left-h.left+p/2,f=d.top-h.top,m=l+" "+t.countLabel,y=" on "+u+" "+c[0]+", "+c[2];t.tip.setValues(g,f,{name:y,value:m,valueFirst:1},[]),t.tip.showTip()}})})}},{key:"renderLegend",value:function(){var t=this;this.legendArea.textContent="";var i=0,s=this.rawChartArgs.radius||0,r=U("subdomain-name",i,12,"Less",{fontSize:11,dy:9});i=30,this.legendArea.appendChild(r),this.colors.slice(0,5).map(function(l,c){var u=It("heatmap-legend-unit",i+15*c,12,10,s,l);t.legendArea.appendChild(u)});var o=U("subdomain-name",i+75+3,12,"More",{fontSize:11,dy:9});this.legendArea.appendChild(o)}},{key:"getDomains",value:function(){for(var t=this.state,i=[t.start.getMonth(),t.start.getFullYear()],s=i[0],r=i[1],o=[t.end.getMonth(),t.end.getFullYear()],l=o[0]-s+1+12*(o[1]-r),c=[],u=O(t.start),h=0;h<l;h++){var d=t.end;if(!Qe(u,t.end)){var p=[u.getMonth(),u.getFullYear()];d=Ot(p[0],p[1])}c.push(this.getDomainConfig(u,d)),H(d,1),u=d}return c}},{key:"getDomainConfig",value:function(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",s=[t.getMonth(),t.getFullYear()],r=s[0],o=s[1],l=Ut(t),c={index:r,cols:[]};H(i=O(i)||Ot(r,o),1);for(var u,h=ot(l,i),d=[],p=0;p<h;p++)u=this.getCol(l,r),d.push(u),H(l=new Date(u[6].yyyyMmDd),1);return u[6].dataValue!==void 0&&(H(l,1),d.push(this.getCol(l,r,!0))),c.cols=d,c}},{key:"getCol",value:function(t,i){for(var s=arguments.length>2&&arguments[2]!==void 0&&arguments[2],r=this.state,o=O(t),l=[],c=0;c<7;c++,H(o,1)){var u={},h=o>=r.start&&o<=r.end;s||o.getMonth()!==i||!h?u.yyyyMmDd=rt(o):u=this.getSubDomainConfig(o),l.push(u)}return l}},{key:"getSubDomainConfig",value:function(t){var i,s,r=rt(t),o=this.data.dataPoints[r];return{yyyyMmDd:r,dataValue:o||0,fill:this.colors[i=o,s=this.state.distribution,s.filter(function(l){return l<i}).length]}}}]),a}();function on(e,n){e.labels=e.labels||[];var a=e.labels.length,t=e.datasets,i=new Array(a).fill(0);return t||(t=[{values:i}]),t.map(function(s){if(s.values){var r=s.values;r=(r=r.map(function(o){return isNaN(o)?0:o})).length>a?r.slice(0,a):ut(r,a-r.length,0),s.values=r}else s.values=i;s.chartType||(s.chartType=n)}),e.yRegions&&e.yRegions.map(function(s){if(s.end<s.start){var r=[s.end,s.start];s.start=r[0],s.end=r[1]}}),e}function ln(e){var n=e.labels.length,a=new Array(n).fill(0),t={labels:e.labels.slice(0,-1),datasets:e.datasets.map(function(i){return{name:"",values:a.slice(0,-1),chartType:i.chartType}})};return e.yMarkers&&(t.yMarkers=[{value:0,label:""}]),e.yRegions&&(t.yRegions=[{start:0,end:0,label:""}]),t}var ft=function(e){j(a,mt);var n=W(a);function a(t,i){var s;return P(this,a),(s=n.call(this,t,i)).barOptions=i.barOptions||{},s.lineOptions=i.lineOptions||{},s.type=i.type||"line",s.init=1,s.setup(),s}return S(a,[{key:"setMeasures",value:function(){this.data.datasets.length<=1&&(this.config.showLegend=0,this.measures.paddings.bottom=30)}},{key:"configure",value:function(t){L(w(a.prototype),"configure",this).call(this,t),t.axisOptions=t.axisOptions||{},t.tooltipOptions=t.tooltipOptions||{},this.config.xAxisMode=t.axisOptions.xAxisMode||"span",this.config.yAxisMode=t.axisOptions.yAxisMode||"span",this.config.xIsSeries=t.axisOptions.xIsSeries||0,this.config.shortenYAxisNumbers=t.axisOptions.shortenYAxisNumbers||0,this.config.numberFormatter=t.axisOptions.numberFormatter,this.config.yAxisRange=t.axisOptions.yAxisRange||{},this.config.formatTooltipX=t.tooltipOptions.formatTooltipX,this.config.formatTooltipY=t.tooltipOptions.formatTooltipY,this.config.valuesOverPoints=t.valuesOverPoints,this.config.legendRowHeight=30}},{key:"prepareData",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.data;return on(t,this.type)}},{key:"prepareFirstData",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.data;return ln(t)}},{key:"calc",value:function(){var t=arguments.length>0&&arguments[0]!==void 0&&arguments[0];this.calcXPositions(),t||this.calcYAxisParameters(this.getAllYValues(),this.type==="line"),this.makeDataByIndex()}},{key:"calcXPositions",value:function(){var t=this.state,i=this.data.labels;t.datasetLength=i.length,t.unitWidth=this.width/t.datasetLength,t.xOffset=t.unitWidth/2,t.xAxis={labels:i,positions:i.map(function(s,r){return jt(t.xOffset+r*t.unitWidth)})}}},{key:"calcYAxisParameters",value:function(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"false",s=nn(t,i,this.config.yAxisRange),r=this.height/sn(s),o=Gt(s)*r,l=this.height-an(s)*o;this.state.yAxis={labels:s,positions:s.map(function(c){return l-c*r}),scaleMultiplier:r,zeroLine:l},this.calcDatasetPoints(),this.calcYExtremes(),this.calcYRegions()}},{key:"calcDatasetPoints",value:function(){var t=this.state,i=function(s){return s.map(function(r){return K(r,t.yAxis)})};t.datasets=this.data.datasets.map(function(s,r){var o=s.values,l=s.cumulativeYs||[];return{name:s.name&&s.name.replace(/<|>|&/g,function(c){return c=="&"?"&amp;":c=="<"?"&lt;":"&gt;"}),index:r,chartType:s.chartType,values:o,yPositions:i(o),cumulativeYs:l,cumulativeYPos:i(l)}})}},{key:"calcYExtremes",value:function(){var t=this.state;this.barOptions.stacked?t.yExtremes=t.datasets[t.datasets.length-1].cumulativeYPos:(t.yExtremes=new Array(t.datasetLength).fill(9999),t.datasets.map(function(i){i.yPositions.map(function(s,r){s<t.yExtremes[r]&&(t.yExtremes[r]=s)})}))}},{key:"calcYRegions",value:function(){var t=this.state;this.data.yMarkers&&(this.state.yMarkers=this.data.yMarkers.map(function(i){return i.position=K(i.value,t.yAxis),i.options||(i.options={}),i})),this.data.yRegions&&(this.state.yRegions=this.data.yRegions.map(function(i){return i.startPos=K(i.start,t.yAxis),i.endPos=K(i.end,t.yAxis),i.options||(i.options={}),i}))}},{key:"getAllYValues",value:function(){var t,i=this,s="values";if(this.barOptions.stacked){s="cumulativeYs";var r=new Array(this.state.datasetLength).fill(0);this.data.datasets.map(function(l,c){var u=i.data.datasets[c].values;l[s]=r=r.map(function(h,d){return h+u[d]})})}var o=this.data.datasets.map(function(l){return l[s]});return this.data.yMarkers&&o.push(this.data.yMarkers.map(function(l){return l.value})),this.data.yRegions&&this.data.yRegions.map(function(l){o.push([l.end,l.start])}),(t=[]).concat.apply(t,T(o))}},{key:"setupComponents",value:function(){var t=this,i=[["yAxis",{mode:this.config.yAxisMode,width:this.width,shortenNumbers:this.config.shortenYAxisNumbers,numberFormatter:this.config.numberFormatter},function(){return this.state.yAxis}.bind(this)],["xAxis",{mode:this.config.xAxisMode,height:this.height},function(){var h=this.state;return h.xAxis.calcLabels=function(d){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],g=!(arguments.length>2&&arguments[2]!==void 0)||arguments[2],f=d/p.length*.6;f<=0&&(f=1);var m,y=f/7;if(g){var x=Math.max.apply(Math,T(p.map(function(b){return b.length})));m=Math.ceil(x/y)}var A=p.map(function(b,D){return(b+="").length>y&&(g?D%m!=0?D!==p.length-1&&(b=""):D>p.length-m/2&&(b=""):b=y-3>0?b.slice(0,y-3)+" ...":b.slice(0,y)+".."),b});return A}(this.width,h.xAxis.labels,this.config.xIsSeries),h.xAxis}.bind(this)],["yRegions",{width:this.width,pos:"right"},function(){return this.state.yRegions}.bind(this)]],s=this.state.datasets.filter(function(h){return h.chartType==="bar"}),r=this.state.datasets.filter(function(h){return h.chartType==="line"}),o=s.map(function(h){var d=h.index;return["barGraph-"+h.index,{index:d,color:t.colors[d],stacked:t.barOptions.stacked,valuesOverPoints:t.config.valuesOverPoints,minHeight:0*t.height},function(){var p=this.state,g=p.datasets[d],f=this.barOptions.stacked,m=this.barOptions.spaceRatio||.5,y=p.unitWidth*(1-m),x=y/(f?1:s.length),A=p.xAxis.positions.map(function(M){return M-y/2});f||(A=A.map(function(M){return M+x*d}));var b=new Array(p.datasetLength).fill("");this.config.valuesOverPoints&&(b=f&&g.index===p.datasets.length-1?g.cumulativeYs:g.values);var D=new Array(p.datasetLength).fill(0);return f&&(D=g.yPositions.map(function(M,z){return M-g.cumulativeYPos[z]})),{xPositions:A,yPositions:g.yPositions,offsets:D,labels:b,zeroLine:p.yAxis.zeroLine,barsWidth:y,barWidth:x}}.bind(t)]}),l=r.map(function(h){var d=h.index;return["lineGraph-"+h.index,{index:d,color:t.colors[d],svgDefs:t.svgDefs,heatline:t.lineOptions.heatline,regionFill:t.lineOptions.regionFill,spline:t.lineOptions.spline,showDots:t.lineOptions.showDots,trailingDot:t.lineOptions.trailingDot,hideDotBorder:t.lineOptions.hideDotBorder,hideLine:t.lineOptions.hideLine,valuesOverPoints:t.config.valuesOverPoints},function(){var p=this.state,g=p.datasets[d],f=p.yAxis.positions[0]<p.yAxis.zeroLine?p.yAxis.positions[0]:p.yAxis.zeroLine;return{xPositions:p.xAxis.positions,yPositions:g.yPositions,values:g.values,zeroLine:f,radius:this.lineOptions.dotSize||4}}.bind(t)]}),c=[["yMarkers",{width:this.width,pos:"right"},function(){return this.state.yMarkers}.bind(this)]];i=i.concat(o,l,c);var u=["yMarkers","yRegions"];this.dataUnitComponents=[],this.components=new Map(i.filter(function(h){return!u.includes(h[0])||t.state[h[0]]}).map(function(h){var d=G.apply(void 0,T(h));return(h[0].includes("lineGraph")||h[0].includes("barGraph"))&&t.dataUnitComponents.push(d),[h[0],d]}))}},{key:"makeDataByIndex",value:function(){var t=this;this.dataByIndex={};var i=this.state,s=this.config.formatTooltipX,r=this.config.formatTooltipY;i.xAxis.labels.map(function(o,l){var c=t.state.datasets.map(function(u,h){var d=u.values[l];return{title:u.name,value:d,yPos:u.yPositions[l],color:t.colors[h],formatted:r?r(d):d}});t.dataByIndex[l]={label:o,formattedLabel:s?s(o):o,xPos:i.xAxis.positions[l],values:c,yExtreme:i.yExtremes[l]}})}},{key:"bindTooltip",value:function(){var t=this;this.container.addEventListener("mousemove",function(i){var s=t.measures,r=J(t.container),o=i.pageX-r.left-X(s),l=i.pageY-r.top;l<t.height+Q(s)&&l>Q(s)?t.mapTooltipXPosition(o):t.tip.hideTip()})}},{key:"mapTooltipXPosition",value:function(t){var i=this.state;if(i.yExtremes){var s=function(o,l){var c=arguments.length>2&&arguments[2]!==void 0&&arguments[2],u=l.reduce(function(h,d){return Math.abs(d-o)<Math.abs(h-o)?d:h},[]);return c?l.indexOf(u):u}(t,i.xAxis.positions,!0);if(s>=0){var r=this.dataByIndex[s];this.tip.setValues(r.xPos+this.tip.offset.x,r.yExtreme+this.tip.offset.y,{name:r.formattedLabel,value:""},r.values,s),this.tip.showTip()}}}},{key:"renderLegend",value:function(){var t=this.data;t.datasets.length>1&&L(w(a.prototype),"renderLegend",this).call(this,t.datasets)}},{key:"makeLegend",value:function(t,i,s,r){return Bt(s,r+5,12,3,this.colors[i],t.name,null,8.75,this.config.truncateLegends)}},{key:"makeOverlay",value:function(){var t=this;this.init?this.init=0:(this.overlayGuides&&this.overlayGuides.forEach(function(i){var s=i.overlay;s.parentNode.removeChild(s)}),this.overlayGuides=this.dataUnitComponents.map(function(i){return{type:i.unitType,overlay:void 0,units:i.units}}),this.state.currentIndex===void 0&&(this.state.currentIndex=this.state.datasetLength-1),this.overlayGuides.map(function(i){var s=i.units[t.state.currentIndex];i.overlay=Be[i.type](s),t.drawArea.appendChild(i.overlay)}))}},{key:"updateOverlayGuides",value:function(){this.overlayGuides&&this.overlayGuides.forEach(function(t){var i=t.overlay;i.parentNode.removeChild(i)})}},{key:"bindOverlay",value:function(){var t=this;this.parent.addEventListener("data-select",function(){t.updateOverlay()})}},{key:"bindUnits",value:function(){var t=this;this.dataUnitComponents.map(function(i){i.units.map(function(s){s.addEventListener("click",function(){var r=s.getAttribute("data-point-index");t.setCurrentDataPoint(r)})})}),this.tip.container.addEventListener("click",function(){var i=t.tip.container.getAttribute("data-point-index");t.setCurrentDataPoint(i)})}},{key:"updateOverlay",value:function(){var t=this;this.overlayGuides.map(function(i){var s=i.units[t.state.currentIndex];Ye[i.type](s,i.overlay)})}},{key:"onLeftArrow",value:function(){this.setCurrentDataPoint(this.state.currentIndex-1)}},{key:"onRightArrow",value:function(){this.setCurrentDataPoint(this.state.currentIndex+1)}},{key:"getDataPoint",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.state.currentIndex,i=this.state,s={index:t,label:i.xAxis.labels[t],values:i.datasets.map(function(r){return r.values[t]})};return s}},{key:"setCurrentDataPoint",value:function(t){var i=this.state;(t=parseInt(t))<0&&(t=0),t>=i.xAxis.labels.length&&(t=i.xAxis.labels.length-1),t!==i.currentIndex&&(i.currentIndex=t,function(s,r,o){var l=document.createEvent("HTMLEvents");for(var c in l.initEvent(r,!0,!0),o)l[c]=o[c];s.dispatchEvent(l)}(this.parent,"data-select",this.getDataPoint()))}},{key:"addDataPoint",value:function(t,i){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.state.datasetLength;L(w(a.prototype),"addDataPoint",this).call(this,t,i,s),this.data.labels.splice(s,0,t),this.data.datasets.map(function(r,o){r.values.splice(s,0,i[o])}),this.update(this.data)}},{key:"removeDataPoint",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.state.datasetLength-1;this.data.labels.length<=1||(L(w(a.prototype),"removeDataPoint",this).call(this,t),this.data.labels.splice(t,1),this.data.datasets.map(function(i){i.values.splice(t,1)}),this.update(this.data))}},{key:"updateDataset",value:function(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.data.datasets[i].values=t,this.update(this.data)}},{key:"updateDatasets",value:function(t){this.data.datasets.map(function(i,s){t[s]&&(i.values=t[s])}),this.update(this.data)}}]),a}(),zt={bar:ft,line:ft,percentage:tn,heatmap:rn,pie:$t,donut:function(e){j(a,$t);var n=W(a);function a(t,i){return P(this,a),n.call(this,t,i)}return S(a,[{key:"configure",value:function(t){L(w(a.prototype),"configure",this).call(this,t),this.type="donut",this.sliceName="donutSlices",this.arcFunc=Re,this.shapeFunc=He,this.strokeWidth=t.strokeWidth||30}},{key:"getRadius",value:function(){return this.height>this.width?this.center.x-this.strokeWidth/2:this.center.y-this.strokeWidth/2}},{key:"resetHover",value:function(t,i){pt(t,"translate3d(0,0,0)"),this.tip.hideTip(),t.style.stroke=i}},{key:"setupComponents",value:function(){var t=this.state,i=[[this.sliceName,{},function(){return{sliceStrings:t.sliceStrings,colors:this.colors,strokeWidth:this.strokeWidth}}.bind(this)]];this.components=new Map(i.map(function(s){var r=G.apply(void 0,T(s));return[s[0],r]}))}}]),a}()},Vt=function e(n,a){return P(this,e),function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"line",i=arguments.length>1?arguments[1]:void 0,s=arguments.length>2?arguments[2]:void 0;return t==="axis-mixed"?(s.type="line",new ft(i,s)):zt[t]?new zt[t](i,s):void console.error("Undefined chart type: "+t)}(a.type,n,a)};frappe.provide("frappe.ui");frappe.Chart=Vt;frappe.ui.RealtimeChart=class extends frappe.Chart{constructor(n,a,t=8,i){super(n,i);i.data.datasets[0].values.length>t&&frappe.throw(__("Length of passed data array is greater than value of maximum allowed label points!")),this.currentSize=i.data.datasets[0].values.length,this.socketEvent=a,this.maxLabelPoints=t,this.start_updating=function(){frappe.realtime.on(this.socketEvent,s=>{this.update_chart(s.label,s.points)})},this.stop_updating=function(){frappe.realtime.off(this.socketEvent)},this.update_chart=function(s,r){this.currentSize>=this.maxLabelPoints?this.removeDataPoint(0):this.currentSize++,this.addDataPoint(s,r)}}};frappe.provide("frappe.ui.keys");var tt=new WeakMap,Xt=[];frappe.ui.keys.shortcut_groups=tt;frappe.ui.keys.get_shortcut_group=e=>(tt.has(e)||tt.set(e,new frappe.ui.keys.AltShortcutGroup),tt.get(e));var Kt=!1,_=null,vt=$(document.body);frappe.ui.keys.bind_shortcut_group_event=()=>{if(Kt)return;Kt=!0;function e(){_?(_.addClass("alt-pressed"),vt.removeClass("alt-pressed")):(vt.addClass("alt-pressed"),_&&_.removeClass("alt-pressed"))}function n(){_&&_.removeClass("alt-pressed"),vt.removeClass("alt-pressed")}$(document).on("keydown",a=>{let t=(frappe.ui.keys.key_map[a.which]||"").toLowerCase();if(t==="alt"&&e(),!(a.shiftKey||a.ctrlKey||a.metaKey)&&t&&a.altKey){let i=cn(t);i&&(a.preventDefault(),i.$target[0].click()),e()}}),$(document).on("keyup",a=>{a.key==="Alt"&&n()}),$(document).on("mousemove",()=>{n()})};function cn(e){let n=Xt.filter(t=>e in t.shortcuts_dict).map(t=>t.shortcuts_dict[e]).filter(t=>t.$target.is(":visible")),a=null;return _&&_.is(".open")&&(a=n.find(t=>$.contains(_[0],t.$target[0]))),a||(a=n.find(t=>$.contains(window.cur_page.page.page.wrapper[0],t.$target[0])),a)}frappe.ui.keys.AltShortcutGroup=class{constructor(){this.shortcuts_dict={},_=null,this.bind_events(),frappe.ui.keys.bind_shortcut_group_event(),Xt.push(this)}bind_events(){$(document).on("show.bs.dropdown",n=>{_&&_.removeClass("alt-pressed");let a=$(n.target);a.is(".dropdown, .btn-group")&&(_=a)}),$(document).on("hide.bs.dropdown",()=>{_&&_.removeClass("alt-pressed"),_=null})}add(n,a){a||(a=n);let t=a.text().trim(),s=t.split("").find(o=>{o=o.toLowerCase();let l=o>="a"&&o<="z";return!this.is_taken(o)&&l});if(!s){a.attr("data-label",encodeURIComponent(t));return}for(let o in this.shortcuts_dict){let l=this.shortcuts_dict[o];if(l.text===t){l.$target=n,l.$text_el=a,this.underline_text(l);return}}let r={$target:n,$text_el:a,letter:s,text:t};this.shortcuts_dict[s.toLowerCase()]=r,this.underline_text(r)}underline_text(n){n.$text_el.attr("data-label",encodeURIComponent(n.text));let a=!1,t=n.text.split("").map(s=>(s===n.letter&&!a&&(s=`<span class="alt-underline">${s}</span>`,a=!0),s)).join("");t=n.$text_el.html().replace(n.text.trim(),t.trim()),n.$text_el.html(t)}is_taken(n){let a=frappe.ui.keys.standard_shortcuts.filter(t=>!t.page).some(t=>t.shortcut===`alt+${n}`);return n in this.shortcuts_dict||a}};frappe.provide("frappe.ui.keys.handlers");frappe.ui.keys.setup=function(){$(window).on("keydown",function(e){var n=frappe.ui.keys.get_key(e);if(frappe.ui.keys.handlers[n]){for(var a=null,t=0,i=frappe.ui.keys.handlers[n].length;t<i;t++){var s=frappe.ui.keys.handlers[n][t],r=s.apply(this,[e]);r===!1&&(a=r)}return a}})};var F=[];frappe.ui.keys.standard_shortcuts=F;frappe.ui.keys.add_shortcut=({shortcut:e,action:n,description:a,page:t,target:i,condition:s,ignore_inputs:r=!1}={})=>{if(i instanceof jQuery){let u=i;n=()=>{u[0].click()}}s||(s=()=>!0);let o=u=>{if(!($(document.activeElement).is("input, select, textarea, [contenteditable=true]")&&!r)&&!!s()&&n&&(!t||t.wrapper.is(":visible"))){let p=n(u);(p||p===void 0)&&u.preventDefault()}};o.page=t,frappe.ui.keys.off(e,t),frappe.ui.keys.on(e,o);let l=F.findIndex(u=>u.shortcut===e),c={shortcut:e,action:n,description:a,page:t,condition:s};l===-1?F.push(c):F[l]=c};frappe.ui.keys.show_keyboard_shortcut_dialog=()=>{if(frappe.ui.keys.is_dialog_shown)return;let e=F.filter(l=>!l.page),n=F.filter(l=>l.page&&l.page===window.cur_page.page.page),a=F.filter(l=>l.page&&l.page===window.cur_page.page.frm);function t(l,c){if(!l.length)return"";let u=l.filter(h=>h.condition?h.condition():!0).filter(h=>!!h.description).map(h=>{let d=h.shortcut.split("+").map(frappe.utils.to_title_case).join("+");return frappe.utils.is_mac()&&(d=d.replace("Ctrl","\u2318")),`<tr>
					<td width="40%"><kbd>${d}</kbd></td>
					<td width="60%">${h.description||""}</td>
				</tr>`}).join("");return u?(u=`<h5 style="margin: 0;">${c}</h5>
			<table style="margin-top: 10px;" class="table table-bordered">
				${u}
			</table>`,u):""}let i=t(e,__("Global Shortcuts")),s=t(n,__("Page Shortcuts")),r=t(a,__("Grid Shortcuts")),o=new frappe.ui.Dialog({title:__("Keyboard Shortcuts"),on_hide(){frappe.ui.keys.is_dialog_shown=!1}});o.$body.append(i),o.$body.append(s),o.$body.append(r),o.$body.append(`
		<div class="text-muted">
			${__("Press Alt Key to trigger additional shortcuts in Menu and Sidebar")}
		</div>
	`),o.show(),frappe.ui.keys.is_dialog_shown=!0};frappe.ui.keys.get_key=function(e){var n=e.keyCode||e.which,a=frappe.ui.keys.key_map[n]||String.fromCharCode(n);return(e.ctrlKey||e.metaKey)&&(a="ctrl+"+a),e.shiftKey&&(a="shift+"+a),e.altKey&&(a="alt+"+a),e.altKey&&e.ctrlKey,a.toLowerCase()};frappe.ui.keys.on=function(e,n){frappe.ui.keys.handlers[e]||(frappe.ui.keys.handlers[e]=[]),frappe.ui.keys.handlers[e].push(n)};frappe.ui.keys.off=function(e,n){let a=frappe.ui.keys.handlers[e];!a||a.length===0||(frappe.ui.keys.handlers[e]=a.filter(t=>n?t.page!==n:!1))};frappe.ui.keys.add_shortcut({shortcut:"ctrl+s",action:function(e){return frappe.app.trigger_primary_action(),e.preventDefault(),!1},description:__("Trigger Primary Action"),ignore_inputs:!0});frappe.ui.keys.add_shortcut({shortcut:"ctrl+g",action:function(e){return $("#navbar-search").focus(),e.preventDefault(),!1},description:__("Open Awesomebar")});frappe.ui.keys.add_shortcut({shortcut:"ctrl+h",action:function(e){e.preventDefault(),$(".navbar-home img").click()},description:__("Navigate Home")});frappe.ui.keys.add_shortcut({shortcut:"alt+s",action:function(e){e.preventDefault(),$(".dropdown-navbar-user a").eq(0).click()},description:__("Open Settings")});frappe.ui.keys.add_shortcut({shortcut:"shift+/",action:function(){frappe.ui.keys.show_keyboard_shortcut_dialog()},description:__("Show Keyboard Shortcuts")});frappe.ui.keys.add_shortcut({shortcut:"alt+h",action:function(e){e.preventDefault(),$(".dropdown-help a").eq(0).click()},description:__("Open Help")});frappe.ui.keys.on("escape",function(e){Jt()});frappe.ui.keys.on("esc",function(e){Jt()});frappe.ui.keys.on("enter",function(e){window.cur_dialog&&cur_dialog.confirm_dialog&&cur_dialog.get_primary_btn().trigger("click")});frappe.ui.keys.on("ctrl+down",function(e){var n=frappe.ui.form.get_open_grid_form();n&&n.toggle_view(!1,function(){n.open_next()})});frappe.ui.keys.on("ctrl+up",function(e){var n=frappe.ui.form.get_open_grid_form();n&&n.toggle_view(!1,function(){n.open_prev()})});frappe.ui.keys.add_shortcut({shortcut:"shift+ctrl+r",action:function(){frappe.ui.toolbar.clear_cache()},description:__("Clear Cache and Reload")});frappe.ui.keys.key_map={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",91:"meta",18:"alt",27:"escape",37:"left",39:"right",38:"up",40:"down",32:"space",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",191:"/",188:"<",190:">"};"abcdefghijklmnopqrstuvwxyz".split("").forEach((e,n)=>{frappe.ui.keys.key_map[65+n]=e});frappe.ui.keyCode={ESCAPE:27,LEFT:37,RIGHT:39,UP:38,DOWN:40,ENTER:13,TAB:9,SPACE:32,BACKSPACE:8};function Jt(){var e;un(),(e=document.activeElement)==null||e.blur()}function un(){var e=$(".grid-row-open");if(e.length){var n=e.data("grid_row");return n.toggle_view(!1),!1}if(cur_dialog&&!cur_dialog.no_cancel_flag&&!cur_dialog.static)return cur_dialog.cancel(),!1}frappe.provide("frappe.utils");var hn={init(){this.jq=jQuery({})},trigger(e,n){!this.jq&&this.init(),this.jq.trigger(e,n)},once(e,n){!this.jq&&this.init(),this.jq.one(e,(a,t)=>n(t))},on(e,n){!this.jq&&this.init(),this.jq.bind(e,(a,t)=>n(t))},off(e,n){!this.jq&&this.init(),this.jq.unbind(e,(a,t)=>n(t))}};frappe.utils.make_event_emitter=function(e){return Object.assign(e,hn),e};})();
//# sourceMappingURL=website.bundle.GUT2OFR4.js.map
